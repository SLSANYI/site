<!DOCTYPE html>
<html lang="zh">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>微信公众号 Markdown 排版编辑器 | Quail 工具</title>
    <meta
      description="简单好用的在线、免费、实时的 Markdown 转微信公众号文章格式的工具，微信公众号排版工具，微信公众号编辑器，微信公众号排版编辑器，Markdown，支持表格、代码、脚注、链接等等，由 Quail 支持"
    />
    <meta
      property="og:title"
      content="微信公众号 Markdown 排版编辑器 | Quail 工具"
    />
    <meta
      property="og:description"
      content="简单好用的在线、免费、实时的 Markdown 转微信公众号文章格式的工具，微信公众号排版工具，微信公众号编辑器，微信公众号排版编辑器，Markdown，支持表格、代码、脚注、链接等等，由 Quail 支持"
    />
    <meta
      property="og:image"
      content="https://quail.ink/portal-images/app-logo.png"
    />
    <meta property="og:url" content="https://quail.ink/tools/markdown-to-wx/" />
    <meta property="og:type" content="website" />
    <meta
      property="og:site_name"
      content="微信公众号 Markdown 排版编辑器 | Quail 工具"
    />
    <meta
      name="twitter:title"
      property="twitter:twitter"
      content="微信公众号 Markdown 排版编辑器 | Quail 工具"
    />
    <meta
      name="twitter:description"
      property="twitter:twitter"
      content="简单好用的在线、免费、实时的 Markdown 转微信公众号文章格式的工具，微信公众号排版工具，微信公众号编辑器，微信公众号排版编辑器，Markdown，支持表格、代码、脚注、链接等等，由 Quail 支持"
    />
    <meta name="twitter:card" content="summary" />
    <link rel="canonical" href="https://quail.ink/tools/markdown-to-wx/" />
    <link
      rel="stylesheet"
      href="https://static.quail.ink/assets/quail-ui/0.2.65/style.css"
    />
    <link rel="stylesheet" href="../comm/style/style.css" />
    <link
      rel="stylesheet"
      href="../vendor/forkawesome/css/fork-awesome.min.css"
    />
    <script src="../comm/script/comm.js"></script>
    <script>
      window.__VUE_PROD_DEVTOOLS__ = true;
    </script>
    <script type="importmap">
      {
        "imports": {
          "vue": "https://cdn.jsdelivr.net/npm/vue@3.3.9/dist/vue.esm-browser.prod.js",
          "quailui": "https://static.quail.ink/assets/quail-ui/0.2.65/index.js",
          "quailjs": "https://cdn.jsdelivr.net/npm/quail-js@0.3.7/+esm"
        }
      }
    </script>
    <script type="module">
      import * as Vue from "vue";
      import QuailUI from "quailui";
      import * as QuailJS from "quailjs";
      window.Vue = Vue;
      window.QuailUI = QuailUI;
      window.QuailJS = QuailJS;
      window.AuxiliaClient = QuailJS.AuxiliaClient;
      window.Client = QuailJS.Client;
    </script>

    <link rel="stylesheet" href="./style/style.css" />
    <link rel="stylesheet" href="../vendor/mde/easymde.min.css" />
    <script src="../vendor/mde/easymde.min.js"></script>
    <script src="../vendor/marked/marked.min.js"></script>
    <script src="../vendor/furiganamd/FuriganaMD.js"></script>
    <script src="./script/wx-renderer.js"></script>
    <script src="./script/wx-renderer-theme-default.js"></script>

    <script type="module">
      const { createApp, ref, onMounted } = window.Vue;

      const app = createApp({
        data() {
          return {
            source: "",
            output: "",
            builtinFonts: [
              {
                label: "衬线",
                value: "serif",
                fonts:
                  "Optima-Regular, Optima, PingFangSC-light, PingFangTC-light, 'PingFang SC', Cambria, Cochin, Georgia, Times, 'Times New Roman', serif",
              },
              {
                label: "无衬线",
                value: "sans-serif",
                fonts:
                  "Roboto, Oxygen, Ubuntu, Cantarell, PingFangSC-light, PingFangTC-light, 'Open Sans', 'Helvetica Neue', sans-serif",
              },
            ],
            currentFont: null,
            mde: null,
            editor: null,
            wxRenderer: null,
            activedTabIndex: 0,
            selectedTab: { id: "editor" },
          };
        },
        computed: {
          convertTabs() {
            return [
              {
                id: "editor",
                title: "编辑",
              },
              {
                id: "preview",
                title: "预览",
              },
            ];
          },
          isSmDown() {
            return window.innerWidth < 600;
          },
          validatedCopy() {
            return this.output.length > 0;
          },
        },
        methods: {
          renderWeChat: function (source) {
            let output = marked(source, {
              renderer: this.wxRenderer.getRenderer(),
            });
            if (this.wxRenderer.hasFootnotes()) {
              output += this.wxRenderer.buildFootnotes();
            }
            return output;
          },
          refresh: function () {
            this.output = this.renderWeChat(this.mde.value());
          },
          copyOutput: function () {
            var clipboardDiv = document.getElementById("output");
            clipboardDiv.focus();
            window.getSelection().removeAllRanges();
            var range = document.createRange();
            range.setStartBefore(clipboardDiv.firstChild);
            range.setEndAfter(clipboardDiv.lastChild);
            window.getSelection().addRange(range);
            document.execCommand("copy");
          },
          convertTabChanged: function (data) {
            if (data.index === 1) {
              this.refresh();
            }
          },
          renderMDEditor: function () {
            const elem = document.getElementById("editor");
            const opts = {
              element: elem,
              initialValue: this.source,
              spellChecker: false,
              nativeSpellcheck: true,
              status: false,
              renderingConfig: {},
              toolbar: [
                "bold",
                "italic",
                "strikethrough",
                "heading-2",
                "heading-3",
                "|",
                "quote",
                "code",
                "image",
                "|",
                "unordered-list",
                "ordered-list",
              ],
            };
            this.mde = new EasyMDE(opts);

            this.mde.codemirror.on("change", () => {
              this.source = this.mde.value();
              this.refresh();
            });
          },
        },
        mounted() {
          console.log("mounted");
          this.selectedTab = this.convertTabs[0];
          this.currentFont = this.builtinFonts[0];
          this.wxRenderer = new WxRenderer({
            theme: WxRendererDefaultTheme,
            fonts: this.currentFont.fonts,
          });

          this.renderMDEditor();
        },
        delimiters: ["${", "}"],
      });

      app.use(window.QuailUI, { debug: false });
      app.mount("#app");
    </script>
  </head>
  <body>
    <div class="container">
      <div class="header">
        <div class="back-home">
          <a href="../" title="Quail.ink"></a>
          <span></span>
        </div>
        <div class="header-inner">
          <h1 class="font-bold">微信公众号 Markdown 排版编辑器</h1>
          <div class="desc">
            简单好用的在线、免费、实时的 Markdown 转微信公众号文章格式的工具
          </div>
        </div>
      </div>

      <div id="app">
        <q-tabs
          v-if="isSmDown"
          v-model="selectedTab"
          :tabs="convertTabs"
          @change="convertTabChanged"
          class="mb-4"
        ></q-tabs>
        <div class="panels" :class="isSmDown ? '' : 'flex frame p-4'">
          <div
            class="panel editor-panel"
            :class="selectedTab.id === 'editor' ? 'active': ''"
          >
            <div class="panel-top-ctrl mb-4">
              <q-fence
                text="撰写文章。完工后点击预览中的「复制」按钮，去公众号文章粘贴"
              ></q-fence>
            </div>
            <textarea
              id="editor"
              v-model="source"
              type="textarea"
              placeholder="在此输入 Markdown"
            ></textarea>
          </div>
          <div
            class="panel preview-panel"
            :class="selectedTab.id === 'preview' ? 'active': ''"
          >
            <div class="panel-top-ctrl mb-4">
              <div>
                <div class="font-bold">文章预览</div>
                <div class="text-xs desc">
                  该预览仅供参考，以公众号实际效果为准
                </div>
              </div>
              <q-button
                @click="copyOutput"
                class="primary copy-button"
                :disabled="!validatedCopy"
                >复制</q-button
              >
            </div>
            <div class="preview-wrapper">
              <div class="preview" contenteditable="true">
                <div v-if="output" id="output" v-html="output"></div>
                <div v-else class="preview-hint">文章预览</div>
              </div>
            </div>
          </div>
        </div>

        <div class="share-bar mb-4 mt-2">
          <div></div>
          <div class="flex">
            <a
              class="quail-icon-wrapper"
              href="https://quail.ink"
              title="Quail.ink"
            >
              <q-icon-quail class="icon"></q-icon-quail>
            </a>
            <q-share
              layout="row"
              url="https://quail.ink/tools/markdown-to-wx/"
              text="微信公众号 Markdown 排版编辑器"
              :services="['twitter', 'mastodon', 'bluesky', 'general']"
            ></q-share>
          </div>
        </div>
      </div>

      <div class="mt-4 md-mt-1">
        <div class="guide-section mb-4 frame">
          <h2 class="guide-title font-bold text-base">
            在 Quail 上同步发布文章
          </h2>
          <div class="guide-content">
            <p>
              既然已经使用 Markdown 写作了，何不在 Quail 上同步发布文章呢？毕竟
              <a href="https://quail.ink" title="了解 Quail">Quail</a>
              是一个强大的发布工具，是博客，邮件通讯的不二之选。<a
                href="https://quail.ink/login"
                title="登录到 Quail"
                >点此马上登录</a
              >。
            </p>
            <p>
              另外，如果希望将微信公众号上的历史文章全部导入到 Quail
              上，请联系我们 contact@quail.ink ，我们会帮您迁移数据。
            </p>
          </div>
        </div>

        <div class="help-section mb-4 frame">
          <h2 class="help-title font-bold text-base">帮助</h2>
          <div class="help-content">
            <p><strong>使用方法</strong></p>
            <ol>
              <li>粘贴 Markdown 文本到输入框中，或者直接在输入框中编辑文章</li>
              <li>
                在撰写过程中，会自动把 Markdown 文本转为微信公众号文章格式
              </li>
              <li>
                点击「复制」按钮，把转换后的微信公众号文章格式复制到剪贴板，然后粘贴到微信公众号编辑器中即可
              </li>
            </ol>
            <p><strong>功能特性：</strong></p>
            <ul>
              <li>支持大部分 Markdown 语法</li>
              <li>
                由于微信公众号文章格式的限制，无法外链，因此本工具会自动把
                Markdown 文本中的链接转为脚注
              </li>
              <li>对于代码，会自动转换为微信公众号支持的代码格式</li>
            </ul>
          </div>
        </div>
      </div>

      <div class="frame p-4 mt-4">
        <script
          async
          src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4634600722062689"
          crossorigin="anonymous"
        ></script>

        <ins
          class="adsbygoogle"
          style="display: block"
          data-ad-client="ca-pub-4634600722062689"
          data-ad-slot="1867918732"
          data-ad-format="auto"
          data-full-width-responsive="true"
        ></ins>
        <script>
          (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
      </div>

      <div class="footer">
        <div class="tools">
          <h2 class="text-base mb-4">Other Tools</h2>
          <div class="grid gap-4 grid-cols-1 md-grid-cols-3 lg-grid-cols-4">
            <div class="toolset">
              <h3 class="text-sm mb-2 font-bold">Utils</h3>
              <a
                href="https://quail.ink/tools/base64/"
                title="Base64 Encoder and Decoder"
                class="mb-2"
                >Base64 Encoder and Decoder</a
              >
              <a
                href="https://quail.ink/tools/qrcode/"
                title="QRCode Generator"
                class="mb-2"
                >QRCode Generator</a
              >
              <a
                href="https://quail.ink/tools/zenkaku-hankaku/"
                title="QRCode Generator"
                class="mb-2"
                >全角、半角変換ツール</a
              >
            </div>
            <div class="toolset">
              <h3 class="text-sm mb-2">Editor Tools</h3>
              <a
                href="https://quail.ink/tools/markdown-to-wx/"
                title="微信公众号 Markdown 排版编辑器"
                class="mb-2"
                >微信公众号 Markdown 排版编辑器</a
              >
              <a
                href="https://quail.ink/tools/wx-to-markdown/"
                title="微信公众号文章转换 Markdown"
                class="mb-2"
                >微信公众号文章转换 Markdown</a
              >
            </div>
          </div>
        </div>
        <div class="copyright">
          Powered by
          <a href="https://quail.ink" target="_blank" title="Quail.ink"
            >Quail</a
          >
        </div>
      </div>
    </div>
    <script
      defer
      src="https://static.cloudflareinsights.com/beacon.min.js/vcd15cbe7772f49c399c6a5babf22c1241717689176015"
      integrity="sha512-ZpsOmlRQV6y907TI0dKBHq9Md29nnaEIPlkf84rnaERnq6zvWvPUqr2ft8M1aS28oN72PdrCzSjY4U6VaAw1EQ=="
      data-cf-beacon='{"rayId":"8978c86ccf037cd1","version":"2024.4.1","token":"4c40dc31e7b14351b39bcac754f380d3"}'
      crossorigin="anonymous"
    ></script>
  </body>
</html>
